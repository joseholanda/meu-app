<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="meu-slider">
  <style>
    :host {
      display: block;
      @apply(--layout-vertical);
    }
    paper-slider{
      width:100%;
    }
    .linha {
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
    }
    h2{
      color: #ccc;
    }
    .colored {
      background: #4285f4;
      color: #fff;
      width: 250px;
    }
  </style>
  <template>
    <iron-ajax id="add" method="put" url="{{url}}" body='{{body}}' on-response="handleAjax"></iron-ajax>

    <h2>Adicionar mamada</h2>
    
    <label>Tempo da mamada: <span>{{tempoDaMamadaString}}</span></label> 
    <paper-slider min="1" max="60" pin value="{{tempoDaMamada}}" on-value-change="mudaValor"/></paper-slider>
    
    <br/>
    <label>Mama:</label>
    <paper-radio-group >
      <paper-radio-button name="E">Esquerda</paper-radio-button>
      <paper-radio-button name="D">Direita</paper-radio-button>
    </paper-radio-group>
    <br/> 

    <label>Data:</label>
    <paper-item >
      <paper-input type="text" value="{{dataDaMamada}}"></paper-input>
    </paper-item>

    <label>Hora de in√≠cio:</label>
    <paper-item >
      <paper-input type="text" value="{{horaDaMamada}}"></paper-input>
    </paper-item>
    

    <paper-button raised class="colored" role="button" on-click="adicionarMamada">
      <paper-ripple></paper-ripple>
      <iron-icon icon="check"></iron-icon> Adicionar
    </paper-button>

  </template>
</dom-module>
<script>
(function() {
  Polymer({
    is: 'meu-slider',

    properties: {
      dataDaMamada: {type:Date,value: new Date()},
      horaDaMamada: {type:String,value: "19:50"},
      tempoDaMamada: Number,
      tempoDaMamadaString : String,
      url:{type:String,value:"http://localhost:9200/mamadas/mamada/"},
      body: String

    },
    domReady: function() {
      console.log("dom");
    },
    ready: function() {
      console.log("-"+this.dataDaMamada)
      this.dataDaMamada = this.formataData(new Date());
      this.tempoDaMamada = 0;
      this.tempoDaMamadaString = '1:00 minuto';

    },

    formataData: function(data) {
      
      var dd = data.getDate();
      var mm = data.getMonth()+1; //January is 0!

      var yyyy = data.getFullYear();
      if(dd<10){
          dd='0'+dd
      } 
      if(mm<10){
          mm='0'+mm
      } 
      var data = dd+'/'+mm+'/'+yyyy;
      return data;
    },

    mudaValor: function () {
      this.tempoDaMamadaString = ""+ this.tempoDaMamada +":00 " + (this.tempoDaMamada==1?"minuto": "minutos");
    },

    handleAjax: function (e, detail, sender) {

      console.log(detail.response);

    },

    adicionarMamada: function () {
        this.body = '{"dataHoraDaMamada":'+ this.dataDaMamada+ ' '+ this.horaDaMamada +', "mama":'+ this.mama+', "duracao":'+this.duracao+', "user":"mariaalice"}';
        var ajax = document.querySelector('iron-ajax');
        ajax.generateRequest();        
    }

  });
})();
</script>
